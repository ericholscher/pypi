<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="standard_template/macros/page">
  <metal:fill fill-slot="body">

    <form method="POST">
      <input type="hidden" name=":action" value="user" />
      <input type="hidden" name="name" tal:condition="not:data/new_user"
	     tal:attributes="value data/name"/>
      <tal:block tal:repeat="field data/openid_fields">
       <input type="hidden" tal:attributes="name python:field[0];value python:field[1]"/>
      </tal:block>
      <table class="form">
	<tr>
	  <th>Username:</th>
	  <td tal:condition="data/new_user"><input name="name" tal:attributes="value data/name"/></td>
	  <td tal:condition="not:data/new_user" tal:content="data/name"></td>
	</tr>
	<tal:block tal:condition="not:data/openid_fields">
	<tr>
	  <th>Password:</th>
	  <td><input type="password" name="password"/></td>
	</tr>
	<tr>
	  <th>Confirm:</th>
	  <td><input type="password" name="confirm" /></td>
	</tr>
        </tal:block>
        <tr tal:condition="data/openid">
          <th>OpenID:</th>
          <td tal:content="data/openid"/>
        </tr>
	<tr>
	  <th>Email Address:</th>
	  <td><input name="email" tal:attributes="value data/email" /></td>
	</tr>
	<tr>
	  <th>PGP Key ID (optional):</th>
	  <td><input name="gpg_keyid" tal:attributes="value data/gpg_keyid" />
          (This identifies a <a
          href="http://www.gnupg.org/documentation/howtos.html">PGP or GPG
          key</a>)
          </td>
	</tr>
	<tr tal:condition="data/new_user">
           <th>Usage Agreement:</th>
	   <td>By registering to upload content to PyPI, I agree and affirmatively 
	    acknowledge the following:
	    <ol>
	      <li>Content is restricted to Python packages and related information only.</li>
	      <li>Any content uploaded to PyPI is provided on a non-confidential basis.</li>
	      <li>The PSF is free to use or disseminate any content that I upload on an 
		unrestricted basis for any purpose. In particular, the PSF and all other 
		users of the web site are granted an irrevocable, worldwide, royalty-free, 
		nonexclusive license to reproduce, distribute, transmit, display, perform, 
		and publish the content, including in digital form.</li>
	      <li>I represent and warrant that I have complied with all government 
		regulations concerning the transfer or export of any content I upload to PyPI.  
		In particular, if I am subject to United States law, I represent and warrant 
		that I have obtained the proper governmental authorization for the export of 
		the content I upload. I further affirm that any content I provide is not intended 
		for use by a government end-user as defined in part 772 of the United States 
		Export Administration Regulations.</li>
	    </ol>
	    <input type="checkbox" name="agree">I agree</input>
	    </td>
	</tr>
	<tr>
	  <th></th>
	  <td><input type="submit" tal:attributes="value data/action" /></td>
	</tr>
      </table>
    </form>

    <tal:block tal:condition="data/new_user">
      <p>A confirmation email will be sent to the address you nominate above.</p>
      <p>To complete the registration process, visit the link indicated in the
      email.</p>
    </tal:block>

    <tal:block tal:condition="not:data/new_user">
      <form method="POST" tal:repeat="key data/sshkeys">
      <input type="hidden" name=":action" value="delkey" />
      <input type="hidden" name="id" tal:attributes="value key/id" />
      <textarea name="key" cols="50" rows="4" readonly="1" tal:content="key/key"/>
      <input type="submit" value="Delete this key"/>
      </form>
      <form method="POST">
      <input type="hidden" name=":action" value="addkey" />
      <textarea name="key" cols="50" rows="4"> </textarea>
      <input type="submit" value="Add SSH key"/>
      </form>
    </tal:block>

    <tal:block tal:condition="data/openids">
     <p>Your OpenIDs:</p>
     <ul>
       <li tal:repeat="curid data/openids"><span tal:replace="curid/id"/></li>
     </ul>
    </tal:block>

    <p tal:condition="not:data/new_user">Claim OpenID, either from one of these providers:
     <tal:block tal:repeat="prov data/providers">
      <a tal:attributes="href prov/claim">
       <img tal:attributes="src prov/favicon; title prov/title"/>
      </a>
     </tal:block>
    or enter your ID explicitly:
    <form>
      <input type='hidden' name=':action' value='claim'/>
      <input name='openid_identifier' size='60'/>
      <input type='submit' value='Claim'/>
    </form>
    </p>
  </metal:fill>
</html>
